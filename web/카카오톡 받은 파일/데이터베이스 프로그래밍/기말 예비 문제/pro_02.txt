CREATE OR REPLACE TRIGGER t_count
	AFTER INSERT ON professor
	FOR EACH ROW
DECLARE
	PRAGMA AUTONOMOUS_TRANSACTION;
	v_deptno department.deptno%TYPE;
	v_dname department.dname%TYPE;
CURSOR c1 IS
	SELECT grade, count(*) 학생수
	FROM student
	WHERE deptno1 = v_deptno
	GROUP BY grade
	ORDER BY grade;
BEGIN
	v_deptno := :new.deptno;	

	SELECT dname
	INTO v_dname
	FROM department
	WHERE deptno = v_deptno;

	FOR stud_rec IN c1
	LOOP
		DBMS_OUTPUT.PUT_LINE('학과명 : ' || v_dname || ' 학년 : ' || stud_rec.grade || ' 학생수 : ' || stud_rec.학생수);
	END LOOP;
END;
/

