CREATE OR REPLACE PROCEDURE display_stud
IS
	v_max NUMBER;
CURSOR c1 IS
	SELECT studno , name , height , dname, part
	FROM student JOIN department ON (deptno1 =deptno)
	WHERE SUBSTR(jumin,7,1)=2
              ORDER BY height DESC;
BEGIN
	FOR stud_rec IN c1
	LOOP
		SELECT max(height)  INTO v_max
		FROM student JOIN department ON (deptno1=deptno)
		WHERE SUBSTR(jumin,7,1)=2 AND part=stud_rec.part;

		IF(v_max=stud_rec.height ) THEN
		DBMS_OUTPUT.PUT_LINE( stud_rec.studno ||' 학번 '|| stud_rec.name||' 이름 '||stud_rec.height ||' 키 '|| stud_rec.dname||' 학과명 ' );
		END IF;
	END LOOP;
EXCEPTION
	WHEN  NO_DATA_FOUND THEN
	DBMS_OUTPUT.PUT_LINE(' 해당 번호는 없습니다.');
END;
/


SET SERVEROUTPUT ON 
exec display_stud
