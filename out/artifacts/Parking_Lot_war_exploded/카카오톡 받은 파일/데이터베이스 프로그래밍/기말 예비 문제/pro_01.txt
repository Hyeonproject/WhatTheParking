SET SERVEROUTPUT ON;

CREATE OR REPLACE PROCEDURE pro_01
	(vdname department.dname%TYPE)
IS
	v_studcount NUMBER;
	v_profcount NUMBER;
	v_deptno department.deptno%TYPE;
CURSOR c1 IS
	SELECT studno, name, grade
	FROM student
	WHERE deptno1 = v_deptno;
CURSOR c2 IS
	SELECT profno, name, position
	FROM professor
	WHERE deptno = v_deptno;
BEGIN
	SELECT deptno
	INTO v_deptno
	FROM department
	WHERE dname = vdname;

	SELECT COUNT(*)
	INTO v_studcount
	FROM student
	WHERE deptno1 = v_deptno;

	SELECT COUNT(*)
	INTO v_profcount
	FROM professor
	WHERE deptno = v_deptno;
	
	DBMS_OUTPUT.PUT_LINE(vdname || ' 학생은 총 ' || v_studcount || '명입니다.');

	FOR stud_rec IN c1
	LOOP
	DBMS_OUTPUT.PUT_LINE('학번 : ' || stud_rec.studno || ' 학생이름 : ' || stud_rec.name || ' 학년 : '|| stud_rec.grade);
	END LOOP;
	
	DBMS_OUTPUT.PUT_LINE(vdname || ' 교수는 총 ' || v_profcount || '명입니다.');	

	FOR prof_rec IN c2
	LOOP
	DBMS_OUTPUT.PUT_LINE('교수번호 : ' || prof_rec.profno || ' 교수이름 : ' || prof_rec.name || ' 직급 : '|| prof_rec.position);
	END LOOP;	

EXCEPTION
	WHEN NO_DATA_FOUND THEN
		DBMS_OUTPUT.PUT_LINE('해당 학과가 없습니다.');
END ;
/

